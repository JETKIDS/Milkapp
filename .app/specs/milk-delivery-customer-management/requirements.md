# Requirements Document

## Introduction

牛乳屋さんの顧客管理ソフトウェアは、牛乳配達業者が顧客情報、配達スケジュール、注文管理を効率的に行うためのWebアプリケーションです。シンプルで使いやすいインターフェースを提供し、日々の配達業務をサポートします。

## Requirements

### Requirement 1: 顧客管理

**User Story:** 牛乳屋の店主として、顧客の基本情報を登録・編集・削除できるようにしたい。そうすることで、配達先の管理を効率化できる。

#### Acceptance Criteria

1. WHEN ユーザーが新規顧客情報を入力して保存 THEN システムは 顧客データベースに情報を保存し、顧客一覧に表示する
2. WHEN ユーザーが顧客情報を編集して保存 THEN システムは 変更内容をデータベースに反映し、更新完了メッセージを表示する
3. WHEN ユーザーが顧客削除を実行 THEN システムは 確認ダイアログを表示し、承認後に顧客データを削除する
4. IF 必須項目が未入力 THEN システムは バリデーションエラーを表示し、保存を拒否する
5. WHEN ユーザーが顧客一覧を表示 THEN システムは 登録済み顧客の一覧を表示する

### Requirement 2: メーカー管理

**User Story:** 牛乳屋の店主として、取り扱う商品のメーカー情報を管理できるようにしたい。そうすることで、商品の仕入れ先を整理し、効率的な発注ができる。

#### Acceptance Criteria

1. WHEN ユーザーが新規メーカー情報を入力して保存 THEN システムは メーカーデータベースに情報を保存し、メーカー一覧に表示する
2. WHEN ユーザーがメーカー情報を編集して保存 THEN システムは 変更内容をデータベースに反映し、更新完了メッセージを表示する
3. WHEN ユーザーがメーカー削除を実行 THEN システムは 確認ダイアログを表示し、承認後にメーカーデータを削除する
4. IF メーカーに関連する商品が存在 THEN システムは 削除を拒否し、関連商品の削除を促すメッセージを表示する

### Requirement 3: 商品管理

**User Story:** 牛乳屋の店主として、取り扱う商品の情報を管理できるようにしたい。そうすることで、正確な商品情報で注文管理ができる。

#### Acceptance Criteria

1. WHEN ユーザーが新規商品情報を入力して保存 THEN システムは 商品データベースに情報を保存し、商品一覧に表示する
2. WHEN ユーザーが商品情報を編集して保存 THEN システムは 変更内容をデータベースに反映し、更新完了メッセージを表示する
3. WHEN ユーザーが商品削除を実行 THEN システムは 確認ダイアログを表示し、承認後に商品データを削除する
4. WHEN ユーザーが商品を登録 THEN システムは メーカーとの関連付けを必須とする
5. IF 商品に関連する注文が存在 THEN システムは 削除を拒否し、関連注文の確認を促すメッセージを表示する

### Requirement 4: 配達コース管理

**User Story:** 牛乳屋の店主として、配達エリアをコース別に管理できるようにしたい。そうすることで、効率的な配達ルートを計画し、配達員の負担を軽減できる。

#### Acceptance Criteria

1. WHEN ユーザーが新規配達コース情報を入力して保存 THEN システムは 配達コースデータベースに情報を保存し、コース一覧に表示する
2. WHEN ユーザーが配達コース情報を編集して保存 THEN システムは 変更内容をデータベースに反映し、更新完了メッセージを表示する
3. WHEN ユーザーが配達コース削除を実行 THEN システムは 確認ダイアログを表示し、承認後にコースデータを削除する
4. WHEN ユーザーが顧客を登録 THEN システムは 配達コースとの関連付けを可能とする
5. IF 配達コースに関連する顧客が存在 THEN システムは 削除を拒否し、関連顧客の確認を促すメッセージを表示する

### Requirement 5: 配達スケジュール管理

**User Story:** 牛乳屋の店主として、各顧客の配達スケジュールを設定・管理できるようにしたい。そうすることで、効率的な配達ルートを計画できる。

#### Acceptance Criteria

1. WHEN ユーザーが顧客の配達曜日を設定 THEN システムは スケジュール情報をデータベースに保存する
2. WHEN ユーザーが配達スケジュールを表示 THEN システムは 曜日別・コース別に顧客リストを表示する
3. WHEN ユーザーが配達完了をマーク THEN システムは 配達状況を更新し、記録を保存する
4. WHEN ユーザーが配達スケジュールを編集 THEN システムは 変更内容をデータベースに反映する

### Requirement 6: 注文管理

**User Story:** 牛乳屋の店主として、顧客の注文内容を管理できるようにしたい。そうすることで、正確な配達と売上管理ができる。

#### Acceptance Criteria

1. WHEN ユーザーが顧客の注文を入力 THEN システムは 注文データを保存し、配達予定に反映する
2. WHEN ユーザーが注文履歴を表示 THEN システムは 顧客別・期間別の注文履歴を表示する
3. WHEN ユーザーが注文を登録 THEN システムは 顧客と商品の関連付けを必須とする
4. IF 注文数量が在庫数量を超過 THEN システムは 警告メッセージを表示する

### Requirement 7: 配達リスト出力機能

**User Story:** 牛乳屋の店主として、任意の期間とコースを指定して配達リストを出力できるようにしたい。そうすることで、配達員への指示書や配達計画の作成が効率化できる。

#### Acceptance Criteria

1. WHEN ユーザーが開始日と終了日を指定 THEN システムは 指定期間の配達予定を抽出する
2. WHEN ユーザーが配達コースを指定 THEN システムは 指定コースの配達予定のみを抽出する
3. WHEN ユーザーが出力ボタンをクリック THEN システムは 配達リストをPDF形式で生成し、ダウンロード可能にする
4. WHEN ユーザーが出力条件を未指定 THEN システムは 全期間・全コースのデータを対象とする
5. IF 指定条件に該当する配達予定が存在しない THEN システムは 該当データなしのメッセージを表示する

### Requirement 8: 商品リスト出力機能

**User Story:** 牛乳屋の店主として、任意の期間とコースを指定して商品リストを出力できるようにしたい。そうすることで、仕入れ計画や在庫管理が効率化できる。

#### Acceptance Criteria

1. WHEN ユーザーが開始日と終了日を指定 THEN システムは 指定期間の注文商品を抽出する
2. WHEN ユーザーが配達コースを指定 THEN システムは 指定コースの注文商品のみを抽出する
3. WHEN ユーザーが出力ボタンをクリック THEN システムは 商品別の数量集計リストをPDF形式で生成し、ダウンロード可能にする
4. WHEN ユーザーが出力条件を未指定 THEN システムは 全期間・全コースのデータを対象とする
5. IF 指定条件に該当する注文が存在しない THEN システムは 該当データなしのメッセージを表示する

### Requirement 9: 請求書発行機能

**User Story:** 牛乳屋の店主として、顧客別に指定期間の請求書を発行できるようにしたい。そうすることで、正確な請求処理と売上管理ができる。

#### Acceptance Criteria

1. WHEN ユーザーが顧客と請求期間を指定 THEN システムは 指定期間の配達実績を抽出する
2. WHEN ユーザーが請求書発行ボタンをクリック THEN システムは 商品別数量と金額を集計し、請求書をPDF形式で生成する
3. WHEN システムが請求書を生成 THEN システムは 顧客情報、請求期間、商品明細、合計金額を含む請求書を作成する
4. WHEN ユーザーが請求書を発行 THEN システムは 請求書発行履歴をデータベースに記録する
5. WHEN ユーザーが請求書履歴を表示 THEN システムは 顧客別・期間別の請求書発行履歴を表示する
6. IF 指定期間に配達実績が存在しない THEN システムは 請求対象データなしのメッセージを表示する

### Requirement 10: 顧客契約商品・配達パターン設定機能

**User Story:** 牛乳屋の店主として、顧客ごとに契約商品とお届けパターンを設定できるようにしたい。そうすることで、定期的な配達スケジュールを自動化し、効率的な配達計画を立てられる。

#### Acceptance Criteria

1. WHEN ユーザーが顧客の契約商品を設定 THEN システムは 商品と配達パターン（曜日・数量）を関連付けて保存する
2. WHEN ユーザーが配達パターンを設定 THEN システムは 曜日別の配達数量を指定可能にする
3. WHEN ユーザーが顧客を配達コースに登録 THEN システムは 指定されたコースに顧客を関連付ける
4. WHEN ユーザーがコース内の配達順番を変更 THEN システムは 順番を更新し、他の顧客の順番を自動調整する
5. WHEN システムが日々のリストを生成 THEN システムは 契約商品・配達パターン・コース順番に基づいて配達リストを作成する
6. WHEN ユーザーが契約商品を無効化 THEN システムは 該当商品の配達を停止し、契約状態を更新する

### Requirement 11: 顧客詳細表示機能

**User Story:** 牛乳屋の店主として、任意の顧客を選択したときに、その顧客の詳細情報を一目で確認できるようにしたい。そうすることで、個別の顧客対応を効率的に行える。

#### Acceptance Criteria

1. WHEN ユーザーが顧客を選択 THEN システムは 顧客の登録されている配達コースを表示する
2. WHEN ユーザーが顧客詳細を表示 THEN システムは コース内での配達順番を表示する
3. WHEN ユーザーが顧客詳細を表示 THEN システムは カレンダー形式で契約商品とお届け予定日を表示する
4. WHEN ユーザーが顧客詳細を表示 THEN システムは 月の請求額を表示する
5. WHEN ユーザーがカレンダーの日付を選択 THEN システムは その日の配達予定商品の詳細を表示する

### Requirement 12: ダッシュボード

**User Story:** 牛乳屋の店主として、今日の配達予定や重要な情報を一目で確認できるようにしたい。そうすることで、日々の業務を効率的に開始できる。

#### Acceptance Criteria

1. WHEN ユーザーがダッシュボードにアクセス THEN システムは 今日の配達予定顧客数を表示する
2. WHEN ユーザーがダッシュボードにアクセス THEN システムは 未完了の配達リストを表示する
3. WHEN ユーザーがダッシュボードにアクセス THEN システムは 今月の売上概要を表示する
4. WHEN ユーザーがダッシュボードにアクセス THEN システムは コース別の配達状況を表示する
5. WHEN ユーザーがダッシュボード情報を更新 THEN システムは 最新のデータを取得し、表示を更新する